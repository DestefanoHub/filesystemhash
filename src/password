import java.security.*;
/**
 * Password creates a hash value from the string password.
 * 	It also has a function to verify the password.
 *  
 * @author Victoria Johnson				Date: November 24, 2015
 * 
 */
public class password {

	private String password = "password";
	private String HASHvalue = "HexString";
	
	public void updatePassword(String word)
	{
		password = word;
	}
	
	public String createHASH() throws Exception{
		
		MessageDigest md = MessageDigest.getInstance("SHA-512");
		md.update(password.getBytes());
		
		byte byteData[] = md.digest();
		
		//convert the byte to hex format method 2
        StringBuffer hexString = new StringBuffer();
    	for (int i=0;i<byteData.length;i++) {
    		String hex=Integer.toHexString(0xff & byteData[i]);
   	     	if(hex.length()==1) hexString.append('0');
   	     	hexString.append(hex);
    	}

    	HASHvalue = hexString.toString();
    	
		return HASHvalue;
	}
	
	public boolean verify(String word) throws Exception{
		
		String test = word; 
		
		MessageDigest md = MessageDigest.getInstance("SHA-512");
		md.update(word.getBytes());
		
		byte byteData[] = md.digest();
		
		//convert the byte to hex format method 2
        StringBuffer hexString = new StringBuffer();
    	for (int i=0;i<byteData.length;i++) {
    		String hex=Integer.toHexString(0xff & byteData[i]);
   	     	if(hex.length()==1) hexString.append('0');
   	     	hexString.append(hex);
    	}
    	
    	test = hexString.toString();
		
    	if(test.compareTo(createHASH()) == 0)
    	{
    		return true;
    	}
    	else
    	{
    		return false;
    	}
	}
}
